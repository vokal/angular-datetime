/*! angular-datetime Copyright Vokal 2015 */
angular.module("vokal.timePicker",[]).directive("timePicker",["$compile","$filter","$document","$timeout",function(a,b,c,d){"use strict";function e(a){return!!a&&angular.isString(a)&&!isNaN(new Date(i+a).getTime())}function f(a){return!!a&&angular.isFunction(a.getTime)&&!isNaN(a.getTime())}function g(a){return f(a)?a:new Date(a)}var h="h:mm a",i="1/1/1990 ";return{restrict:"A",scope:{date:"=ngModel"},require:"ngModel",link:function(j,k,l,m){function n(a){return"string"===l.pickerType?b("date")(a,l.timePicker||h):a}function o(a){return n(j.date?new Date(g(j.date).toDateString()+" "+a):new Date(i+a))}function p(){j.showTimepicker||(j.showTimepicker=!0,d(function(){c.on("click touchstart",y)},50))}function q(){c.off("click touchstart",y),j.showTimepicker=!1}m.$parsers.unshift(function(a){var b=e(a);return m.$setValidity("time",b),b?o(a):j.date}),m.$formatters.push(function(a){var c=g(a),d=f(c);return m.$setValidity("time",d),d?b("date")(c,l.timePicker||h):a}),j.times=[],j.showTimepicker=!1;for(var r,s,t,u=l.pickerInterval?parseInt(l.pickerInterval,10):60,v=0;24>v;v++)for(var w=0;60>w;w+=u)s=10>w?"0"+w:w,r=new Date(i+v+":"+s),t=b("date")(r,l.timePicker||h),j.times.push(t);j.applyTime=function(a){m.$setViewValue(a),m.$render(),q()};var x=angular.element('<ol class="time-picker" data-ng-show="showTimepicker"><li data-ng-repeat="time in times" data-ng-click="applyTime( time )">{{ time }}</li></ol>');a(x)(j),k.after(x),k.on("click",p),k.on("keydown paste",q),j.$on("$destroy",q);var y=function(a){x[0].contains(a.target)||j.$apply(q)}}}}]);